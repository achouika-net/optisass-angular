<div class="fiche-container">
    <!-- Header -->
    <div class="header">
        <div class="client-info">
            <div class="avatar-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                </svg>
            </div>
            <div class="client-details">
                <h2>Client Name</h2>
                <p>NÂ° Client: 2024-0547 â€¢ Tel: 06 12 34 56 78</p>
            </div>
        </div>
        <div class="header-actions">
            <button type="button" class="btn-secondary" (click)="goBack()">Annuler</button>
            <button type="button" class="btn-primary" (click)="onSubmit()" [disabled]="ficheForm.invalid || loading">
                Enregistrer
        </div>
    </div>
    </form>

    <h3>{{ viewingFile.name }}</h3>
    <button type="button" class="btn-close" (click)="closeViewer()">Ã—</button>
</div>
<div class="modal-body">
    <img *ngIf="viewingFile.type.startsWith('image/')" [src]="viewingFile.preview" alt="Prescription">
    <iframe *ngIf="viewingFile.type === 'application/pdf'" [src]="viewingFile.preview" frameborder="0"></iframe>
</div>
</div>
</div>


<!-- Camera Capture Modal -->
<div class="camera-modal" *ngIf="showCameraModal" (click)="closeCamera()">
    <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
            <h3>Capturer une photo de prescription</h3>
            <button type="button" class="btn-close" (click)="closeCamera()">Ã—</button>
        </div>

        <div class="modal-body">
            <!-- Video stream -->
            <div class="camera-container" *ngIf="!capturedImage">
                <video #videoElement autoplay playsinline></video>
            </div>

            <!-- Captured photo preview -->
            <div class="preview-container" *ngIf="capturedImage">
                <img [src]="capturedImage" alt="Photo capturÃ©e">
            </div>

            <!-- Hidden canvas for capture -->
            <canvas #canvasElement style="display: none;"></canvas>
        </div>

        <div class="modal-footer">
            <!-- Buttons before capture -->
            <ng-container *ngIf="!capturedImage">
                <button type="button" class="btn-secondary" (click)="closeCamera()">
                    Annuler
                </button>
                <button type="button" class="btn-primary" (click)="capturePhoto()">
                    ðŸ“· Capturer
                </button>
            </ng-container>

            <!-- Buttons after capture -->
            <ng-container *ngIf="capturedImage">
                <button type="button" class="btn-secondary" (click)="retakePhoto()">
                    â†º Reprendre
                </button>
                <button type="button" class="btn-success" (click)="useCapture()">
                    âœ“ Utiliser cette photo
                </button>
            </ng-container>
        </div>
    </div>
</div>
</div>