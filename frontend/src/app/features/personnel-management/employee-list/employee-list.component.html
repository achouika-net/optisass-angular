<div class="flex flex-col space-y-6">
    <!-- Header -->
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
        <div>
            <h1 class="text-2xl font-bold text-[#1e3a8a] flex items-center gap-2">
                <mat-icon>group</mat-icon>
                Gestion du Personnel
            </h1>
            <p class="text-gray-500">Gérez vos employés et leurs affectations inter-centres.</p>
        </div>
        <div class="flex gap-2">
            <button mat-flat-button color="primary" routerLink="/p/personnel/employees/new"
                class="rounded-lg py-6 px-6">
                <mat-icon>add</mat-icon>
                Nouvel Employé
            </button>
        </div>
    </div>

    <!-- Filters Card -->
    <mat-card class="rounded-xl border-none shadow-sm overflow-hidden">
        <mat-card-content class="p-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Rechercher</mat-label>
                    <input matInput (keyup)="applyFilter()" [(ngModel)]="dataSource.filter"
                        placeholder="Nom, matricule...">
                    <mat-icon matSuffix>search</mat-icon>
                </mat-form-field>

                <mat-form-field appearance="outline" class="w-full">
                    <mat-label>Statut</mat-label>
                    <mat-select [(ngModel)]="filter.statut" (selectionChange)="applyFilter()">
                        <mat-option value="">Tous les statuts</mat-option>
                        <mat-option value="ACTIF">Actif</mat-option>
                        <mat-option value="SUSPENDU">Suspendu</mat-option>
                        <mat-option value="SORTI">Sorti</mat-option>
                    </mat-select>
                </mat-form-field>

                <div class="flex gap-2 pb-1">
                    <button mat-stroked-button color="primary" (click)="resetFilters()" class="rounded-lg h-12">
                        Réinitialiser
                    </button>
                </div>
            </div>
        </mat-card-content>
    </mat-card>

    <!-- Table Card -->
    <mat-card class="rounded-xl border-none shadow-sm overflow-hidden flex-grow">
        <div class="overflow-x-auto">
            <table mat-table [dataSource]="dataSource" matSort class="w-full">

                <!-- Matricule Column -->
                <ng-container matColumnDef="matricule">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Matricule </th>
                    <td mat-cell *matCellDef="let element" class="font-medium text-[#1e3a8a]"> {{element.matricule ||
                        '--'}} </td>
                </ng-container>

                <!-- Nom Column -->
                <ng-container matColumnDef="nom">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Nom </th>
                    <td mat-cell *matCellDef="let element"> {{element.nom}} </td>
                </ng-container>

                <!-- Prenom Column -->
                <ng-container matColumnDef="prenom">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Prénom </th>
                    <td mat-cell *matCellDef="let element"> {{element.prenom}} </td>
                </ng-container>

                <!-- Poste Column -->
                <ng-container matColumnDef="poste">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Poste </th>
                    <td mat-cell *matCellDef="let element">
                        <mat-chip-listbox>
                            <mat-chip-option [selectable]="false" color="accent"
                                selected>{{element.poste}}</mat-chip-option>
                        </mat-chip-listbox>
                    </td>
                </ng-container>

                <!-- Contrat Column -->
                <ng-container matColumnDef="contrat">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Contrat </th>
                    <td mat-cell *matCellDef="let element"> {{element.contrat}} </td>
                </ng-container>

                <!-- Salaire Base Column -->
                <ng-container matColumnDef="salaireBase">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Salaire Base </th>
                    <td mat-cell *matCellDef="let element" class="text-right pr-4"> {{element.salaireBase |
                        number:'1.2-2'}} MAD </td>
                </ng-container>

                <!-- Statut Column -->
                <ng-container matColumnDef="statut">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header> Statut </th>
                    <td mat-cell *matCellDef="let element">
                        <span class="px-3 py-1 rounded-full text-xs font-semibold"
                            [ngClass]="getStatusClass(element.statut)">
                            {{element.statut}}
                        </span>
                    </td>
                </ng-container>

                <!-- Actions Column -->
                <ng-container matColumnDef="actions">
                    <th mat-header-cell *matHeaderCellDef> Actions </th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-icon-button [matMenuTriggerFor]="menu">
                            <mat-icon>more_vert</mat-icon>
                        </button>
                        <mat-menu #menu="matMenu">
                            <button mat-menu-item [routerLink]="['/p/personnel/employees', element.id, 'edit']">
                                <mat-icon>edit</mat-icon>
                                <span>Modifier</span>
                            </button>
                            <button mat-menu-item (click)="deleteEmployee(element)" class="text-red-600">
                                <mat-icon color="warn">delete</mat-icon>
                                <span>Supprimer</span>
                            </button>
                        </mat-menu>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="hover:bg-gray-50 transition-colors">
                </tr>

                <!-- Row shown when there is no matching data. -->
                <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell p-8 text-center text-gray-400" colspan="8">
                        Aucun employé trouvé.
                    </td>
                </tr>
            </table>
        </div>

        <mat-paginator [pageSizeOptions]="[10, 25, 50]" showFirstLastButtons class="border-t"></mat-paginator>
    </mat-card>
</div>